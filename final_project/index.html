<!DOCTYPE html>
<html lang="en">
  <head>
  
    <title>PS70: Intro to Digital Fabrication --- FINAL PROJECT</title>
  
    <!-- External Stylesheets -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
  
    <!-- Internal Stylesheets -->
    <!-- <link href="./style.css" rel="stylesheet"> -->
    <link href="../static/styles.css" rel="stylesheet">
  
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&display=swap" rel="stylesheet">
    
    <!-- Arduino Code Style -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script> 
  </head>

<body>

  <br>
  <br>

<header id="header">
    <!-- Nav -->
      <nav>
        <ul>
          <li><a href="../index.html">Explorations</a></li>
          <li><a href="../about.html">About</a></li>
        </ul>
      </nav>
</header>


  <div class="aboutme">
    <div class="subhead">
      <div class="blue heavy">Final Project</div> Claire's Snap Shots
    </div>
    <div class="demi blue bigger">
      Overview:
    </div>
    <ol>
        <li><b class="blue">Demo Video</b>
        </li>
        <li><b class="blue">Inspiration and Motivation</b>   
        </li>
        <li><b class="blue">How To Use It</b>       
        </li>
        <li><b class="blue">Hardware</b>
          <ul>
              <li>Materials</li>
              <li>Pin Layout</li>
          </ul>        
        </li>
        <li><b class="blue">Software</b>
          <ul>
              <li>Final Code</li>
          </ul>        
        </li>
        <li><b class="blue">The Process</b>
          <ul>
              <li>Making the Press-Fit Box</li>
              <li>Making the Vacuum-Sealed Shotglass Containers</li>
              <li>Wiring it Up and Creating the Code</li>
          </ul>        
        </li>
        <li><b class="blue">Future Hopes</b>
          <ul>
              <li>More Shotglasses</li>
              <li>LED Integration</li>
              <li>Website Integration</li>
          </ul>        
      </li>
    </ol>
    <hr>
    <div>
      <br>
      <b class="blue">Final Project Guidelines</b>
      <br>
      Final projects should integrate most of the skills covered over the semester, including at a minimum:
      <ol>
        <li>3D design and fabrication (either mold/cast, 3D print, lasercut, etc.)</li>
        <li>Electronics (input and output)</li>
        <li>Microcontroller programming</li>
      </ol>
      <br>
      <hr>
      <br>
<!-- //////////////////BEGIN!!!/////////////////////////////////////////////// -->

      <div class="subhead">
        <div class="blue heavy">Demo Video</div>
      </div>

      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">Inspiration and Motivation</div>
      </div>

      PS70's course title is Introduction to Digital Fabrication. 
      But as Nathan and our TFs and CAs emphasized to us in the class, PS70 also serves as an introduction to <i>personal fabrication</i>, 
      giving us the tools, skills, and confidence we need to create anything we want -- especially those items that are uniquely useful to us, and maybe aren't mass-produced or are rather expensive.
      <br><br>
      So I thought to myself: what do I <i>uniquely</i> need?
      <br><br>
      Well, I collect shotglasses! My collection numbers more than 80 by now, giving me a whole host of unique needs: how do I transport and display 80+ shotglasses? And how do I keep track of all of them?

      <br><br>
      <span class="subsubhead heavy">Project Goal:</span> Create a device which tells the user unique information about whichever of my shotglasses is placed upon it.
      <br><br>
      I wanted a device that was compact and easy to transport 
      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">How to Use It</div>
      </div>

      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">Hardware</div>
      </div>

        <div class="subsubhead">
          1. Materials
        </div>

        <div class="subsubhead">
          2. Pin Layout
        </div>

      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">Software</div>
      </div>
        <div class="subsubhead">
          1. Final Code
        </div>

        <div class="subsubhead">
          2. Zooming In: RFID
        </div>

        <div class="subsubhead">
          3. Zooming In: Arrays
        </div>

        <div class="subsubhead">
          4. Zooming In: TFT_eSPI
        </div>

        <div class="subsubhead">
          5. Zooming In: Buttons
        </div>

        <div class="subsubhead">
          2. Pin Layout
        </div>

      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">The Process</div>
      </div>

        <div class="subsubhead">
          1. Making the Press-Fit Box
        </div>

        <div class="subsubhead">
          2. Making the Vacuum-Sealed Containers
        </div>
      
    
      <!-- //////////////////////////////////////////////////////////////////// -->
      <div class="subhead">
        <div class="blue heavy">Future Hopes</div>
      </div>

        <div class="subsubhead">
          1. More Shotglasses
        </div>

        <div class="subsubhead">
          2. LED Integration
        </div>

        <div class="subsubhead">
          3. Website Integration
        </div>


      <div>
        This week, I teamed up with my dear tablemates Connor and Jackson. :D
        <br><br>
        Since I want to use RFID sensing in my final project and Connor wanted to create a physical robot that would listen to directions for his final project, 
        we decided to create a robot on wheels who moves in response to corresponding RFID tags. Thus, RFID sensing was our input, movement of the robot was our output, and we decided to use Internet as the connection.
        <br><br>
        We split it up so that I would handle the RFID sensing, Connor the robot, and Jackson the connection from one to the other via Internet.

        To get a better sense of our project, check out <a href="https://cjleggett.github.io/ps70/weeks/9.html">Connor's</a> and <a href="https://jacksonmoody.github.io/PS70/week9">Jackson's</a> websites for a better look at the cool things they did, 
        including creating the Roomba-like robot, sending the motor commands, and a prototype that used 4 buttons instead!

        <br><br>

        
        <b class="blue">RFID:</b>
        I used the RFID RC522 Module! To ensure that we could send signals to the Internet, I hooked it up to an ESP32.

        <br>
        The RFID setup and tags:
        <img alt="Circuit" src="./circuits.jpg" width="30%">
        <img alt="RFID Tags" src="./RFID_tags.JPG" width="30%">
        (Note the fine soldering work)

        <br><br>
        <br>
        It took me a while to properly interface with the RFID sensor since I didn't have the exact ESP32-WROOM-32 model that most tutorials used, and the ESP32-S2-SOLO I was using was missing some of the necessary pins for these tutorials.
        I tried 4-5 different tutorials and studied the spec sheets of the <a href="https://www.espressif.com/sites/default/files/documentation/esp32-s2-solo_esp32-s2-solo-u_datasheet_en.pdf">ESP32-S2-SOLO2</a> and the <a href="https://www.espressif.com/sites/default/files/documentation/esp32-wroom-32_datasheet_en.pdf">ESP32-WROOM-32</a> to appropriately replace one GPIO pin for another.
        Finally, by simply replacing using the ESP32-Mini (thanks Nathan!) instead, I was able to find all of the pins I needed and got the reader to scan tags.
        <br><br>
        After finally getting the RFID Reader to sense the presence of RFID tags and display their UIDs with the help of the excellent "MFRC522.h" Arduino library package, 
        I modified Connor's code for connecting to the NodeJS server and POSTing commands as well as code from tutorials on <a href="https://esp32io.com/tutorials/esp32-rfid-nfc">esp32.io.com</a> and <a href="https://randomnerdtutorials.com/security-access-using-mfrc522-rfid-reader-with-arduino/">Random Nerd Tutorials</a>
        to create code that would POST either forward, backward, left, or right commands online depending on the unique tag that it scanned.

        The final code for the input to the ESP32-Mini microcontroller (with my notes about specific pin wiring):
        <pre><code class="language-arduino">
            #include <SPI.h>
            #include <MFRC522.h>
            
            //#include "Constants.h"
            #include <WiFi.h>
            #include <HTTPClient.h>
            #include <ArduinoJson.h>
            
            //ESP32-SOLO-S2
            //SDA --> ESP32 5 GPIO5
            //SCK --> ESP32 11 GPIO18
            //MOSI --> 21 GPIO21 (altered)
            //MISO --> 19 GPIO19
            //IRQ attached to nothing
            //GND --> GND
            //RST --> 20 GPIO20 (altered)
            //VCC --> 3.3V
            
            //ESP32-Mini
            //SDA --> ESP32 5 GPIO5
            //SCK --> ESP32 11 GPIO18
            //MOSI --> 23 GPIO23
            //MISO --> 19 GPIO19
            //IRQ attached to nothing
            //GND --> GND
            //RST --> 27 GPIO27
            //VCC --> 3.3V
            
            const char* ssid = "MAKERSPACE";
            const char* password = "12345678";
            
            const String speedUrl = "https://ps70-api.vercel.app/speed";
            const String directionUrl = "https://ps70-api.vercel.app/direction";
            
            #define SS_PIN  5  //ESP32 pin GIOP5 
            #define RST_PIN 27 //ESP32 pin GIOP20
            
            MFRC522 rfid(SS_PIN, RST_PIN);
            
            void setup() {
              
              Serial.begin(9600);
              // Connect to the wifi
              WiFi.begin(ssid, password);
              while (WiFi.status() != WL_CONNECTED) {
                delay(1000);
                Serial.println("Connecting to WiFi");
              }
              Serial.println("Connected to the WiFi network");
              
              SPI.begin(); // init SPI bus
              rfid.PCD_Init(); // init MFRC522
            
              Serial.println("Tap an RFID/NFC tag on the RFID-RC522 reader");
            }
            
            void loop() {
              if (rfid.PICC_IsNewCardPresent()) { // new tag is available
                if (rfid.PICC_ReadCardSerial()) { // NUID has been readed
                  
                  // print Tag Type
                  MFRC522::PICC_Type piccType = rfid.PICC_GetType(rfid.uid.sak);
                  Serial.print("RFID/NFC Tag Type: ");
                  Serial.println(rfid.PICC_GetTypeName(piccType));
            
                  // print UID in Serial Monitor in the hex format
                  Serial.print("UID:");
                  String content = "";
                  byte letter;
                  for (byte i = 0; i < rfid.uid.size; i++) {
                    Serial.print(rfid.uid.uidByte[i] < 0x10 ? " 0" : " ");
                    Serial.print(rfid.uid.uidByte[i], HEX);
                    content.concat(String(rfid.uid.uidByte[i] < 0x10 ? " 0" : " "));
                    content.concat(String(rfid.uid.uidByte[i], HEX));
                  }
                  Serial.println();
                  content.toUpperCase();
            
                  // Forward Tag
                  if (content.substring(1) == "A1 7C 8D 1D") {
                    Serial.println("Forward Tag Recognized!");
                    Serial.println();
                    String direction = "forward";
                    Serial.println("direction=" + direction + "&time=" + millis());
                    if ((WiFi.status() == WL_CONNECTED)) {
                      HTTPClient http;
                      http.begin(directionUrl + "?direction=" + direction + "&time=" + millis());
                      int httpResponseCode = http.POST("");
                      String payload = http.getString();
                      Serial.println(payload);
                      Serial.println(httpResponseCode);
                      Serial.println("POSTED :D");
                      http.end();
                    }
                    else {
                      Serial.println("Wifi not detected.");
                    }
                  }
                  // Backwards Tag
                  else if (content.substring(1) == "2A 2A 75 17") {
                    Serial.println("Backward Tag Recognized!");
                    Serial.println();
                    String direction = "backward";
                    Serial.println("direction=" + direction + "&time=" + millis());
                    if ((WiFi.status() == WL_CONNECTED)) {
                      HTTPClient http;
                      http.begin(directionUrl + "?direction=" + direction + "&time=" + millis());
                      int httpResponseCode = http.POST("");
                      String payload = http.getString();
                      Serial.println(payload);
                      Serial.println(httpResponseCode);
                      Serial.println("POSTED :D");
                      http.end();
                    }
                    else {
                      Serial.println("Wifi not detected.");
                    }
                  }
            
                  // Left Tag
                  else if (content.substring(1) == "37 23 27 7B") {
                    Serial.println("Left Tag Recognized!");
                    Serial.println();
                    String direction = "left";
                    Serial.println("direction=" + direction + "&time=" + millis());
                    if ((WiFi.status() == WL_CONNECTED)) {
                      HTTPClient http;
                      http.begin(directionUrl + "?direction=" + direction + "&time=" + millis());
                      int httpResponseCode = http.POST("");
                      String payload = http.getString();
                      Serial.println(payload);
                      Serial.println(httpResponseCode);
                      Serial.println("POSTED :D");
                      http.end();
                    }
                    else {
                      Serial.println("Wifi not detected.");
                    }
                  }
            
                  // Right Tag
                  else if (content.substring(1) == "F7 08 2A 7B") {
                    Serial.println("Right Tag Recognized!");
                    Serial.println();
                    String direction = "right";
                    Serial.println("direction=" + direction + "&time=" + millis());
                    if ((WiFi.status() == WL_CONNECTED)) {
                      HTTPClient http;
                      http.begin(directionUrl + "?direction=" + direction + "&time=" + millis());
                      int httpResponseCode = http.POST("");
                      String payload = http.getString();
                      Serial.println(payload);
                      Serial.println(httpResponseCode);
                      Serial.println("POSTED :D");
                      http.end();
                    }
                    else {
                      Serial.println("Wifi not detected.");
                    }
                  }
            
                  else {
                    Serial.println("Tag not recognized.");
                  }
            
                  rfid.PICC_HaltA(); // halt PICC
                  rfid.PCD_StopCrypto1(); // stop encryption on PCD
                }
              }
            }
        </code></pre>

        <li><a download href="./final_rfid/final_rfid.ino"> Download my Arduino Code </a><br></li>


        <br><br>

        The Final Result!
        <img alt="Boomba" src="./Boomba.jpg" width="30%">
        <br><br>
        Demo!:<br>
        <video width="50%" controls>
          <source src="./meet_Boomba.MOV" type="video/mp4">
        Your browser does not support the video tag.
        </video>

    </div>
    
    

    <br>
 
  </div>

</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" ></script>

</html>